<%- include ../header %>	
	<link rel="stylesheet" type="text/css" href="/stylesheets/question.css">
<%- include ../nav %>
	<div id="container">
		<div id="wenda-main">
			<div id="wenda-recommand">
				<h2>编辑推荐</h2>
				<ul id="recommand-list">
					<li><a href="javascript:void(0)">我是推荐一</a></li>
					<li><a href="javascript:void(0)">我是推荐一</a></li>
					<li><a href="javascript:void(0)">我是推荐一</a></li>
					<li><a href="javascript:void(0)">我是推荐一</a></li>
				</ul>
			</div>
			<ul id="wenda-nav">
				<li id="nav-hot"><a href="javascript:void(0)">最热</a></li>
				<li id="nav-new"><a href="javascript:void(0)">最新</a></li>
				<li id="nav-unanswered"><a href="javascript:void(0)">未答</a></li>
			</ul>
			<div id="wenda-list">
			<% questions.forEach(function (question) { %>
				<div class="wenda-container">
					    <div class="wenda-img">
					       <img class="wenda-img-icon" src="images/7.jpg">
					       <span><%= question.name %></span>
					     </div>
					    <div class="wenda-content">
							<h1 class="wenda-title">
								<a href="/questionDetail?name=<%= question.name %>&day=<%= question.time.day %>&quesTitle=<%= question.quesTitle %>"><%= question.quesTitle %></a>
							</h1>
							<p class="wenda-description"><%= question.quesDetail %></p>
							<div class="action-panel">
							    提问的日期：<%= question.time.minute %> |
								<a href="/questionDetail?name=<%= question.name %>&day=<%= question.time.day %>&quesTitle=<%= question.quesTitle %>">评论</a> |
								<a href="/questionDetail?name=<%= question.name %>&day=<%= question.time.day %>&quesTitle=<%= question.quesTitle %>">已有 <%=question.comments.length%> 条回答</a>
								<a id="agree<%=question.name%>" name="agree" href="javascript:agree('<%=question.name%>','<%= question.time.day %>','<%= question.quesTitle %>')" onclick=good('<%=question.name%>')>赞 <span><%=question.agreeNum%></span> </a>
								<a id="disagree<%=question.name%>" name="disagree" href="javascript:disagree('<%=question.name%>','<%= question.time.day %>','<%= question.quesTitle %>')" onclick=notgood('<%=question.name%>')>踩 <span><%=question.disagreeNum%></span> </a>
							</div>
					    </div>				
				</div>
			<% }) %>
			</div>
			<!-- 分页 -->
			<div id="pageslider">
			     <%- include ../paging %>
			</div>
			
		</div>
		<div id="wenda-siderbar">
			<div id="ask">
				<a href="/ask">我要提问</a>
			</div>
			<div id="user-about">
				<div id="user-skin">
					<div id="headpic">
						<img id="headpic-img" src="images/7.jpg">
					</div>
				</div>
				<div id="user-wendainfo">
					<div id="namebox"><%= user.name %></div>
					<ul id="user-action">
						<li><a href=""><strong class="user-action" id="user-question">100</strong><span>提问</span></a></li>
						<li><a href=""><strong class="user-action" id="user-answer">100</strong><span>回答</span></a></li>
						<li><a href=""><strong class="user-action" id="user-focus">100</strong><span>关注</span></a></li>
					</ul>
				</div>
			</div>
			<div id="follow-class">
				其他模块
			</div>
		</div>
	</div>
	<footer>
		<hr/>
		我是footer。<br/>
		我是footer。<br/>
		我是footer。<br/>
		我是footer。<br/>
		我是footer。
	</footer>
<script type="text/javascript" src="/javascripts/jquery.js"></script>
<script type="text/javascript">
    function good(name)
    {
    	document.getElementById('agree'+name).getElementsByTagName('span')[0].innerText=parseInt(document.getElementById('agree'+name).getElementsByTagName('span')[0].innerText)+1;
    }
    function notgood(name)
    {
    	document.getElementById('disagree'+name).getElementsByTagName('span')[0].innerText=parseInt(document.getElementById('disagree'+name).getElementsByTagName('span')[0].innerText)+1;
    }
  	function agree(name,day,quesTitle){
			var params ={
                "name":name,
                "day":day,
                "quesTitle":quesTitle,
            };
            
            $.ajax({
                data: params,
                url: '/agree',
                type:'post',
                jsonpCallback: 'callback',
                success: function(data){
                	console.log('这是data');
                	console.log(data);
                	console.log('这是data');
                   
                  // $('#agree'+name).html("赞 "+data);
                  
                },
                error: function(jqXHR, textStatus, errorThrown){
                    alert('error ' + textStatus + " " + errorThrown);  
                }
            });
            console.log(222);
		}
		function disagree(name,day,quesTitle){
			var params ={
                "name":name,
                "day":day,
                "quesTitle":quesTitle,
            };
            
            $.ajax({
                data: params,
                url: '/disagree',
                type:'post',
                jsonpCallback: 'callback',
                success: function(data){
                	console.log('这是data');
                	console.log(data);
                	console.log('这是data');
                   
                  // $('#agree'+name).html("赞 "+data);
                  
                },
                error: function(jqXHR, textStatus, errorThrown){
                    alert('error ' + textStatus + " " + errorThrown);  
                }
            });
            console.log(222);
		}
	</script>
<%- include ../footer %>