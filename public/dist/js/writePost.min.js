!function(){function e(){c.style.display="block"}function t(e){for(var t=!1,e=EventUtil.getEvent(e),n=EventUtil.getTarget(e);n;){if(n==u){t=!0;break}n=n.parentNode}if(!t){c.style.display="none";var l=r.value,o=l.split(","),a=document.createDocumentFragment();if(l){for(var i=0;i<o.length;i++){var s=document.createElement("span");s.className="tag-style ",s.backgroundColor="#EEEB7E",s.innerHTML=o[i],a.appendChild(s)}r.value="",d.appendChild(a);var v=d.offsetWidth;r.style.paddingLeft=v+5+"px"}}}function n(e){var e=EventUtil.getEvent(e),t=EventUtil.getTarget(e);"span"==t.tagName.toLowerCase()&&l(t)}function l(e){for(var t=i(),n=null,l=d.getElementsByTagName("span"),o=0;o<l.length;o++)if(l[o].innerHTML==e.innerHTML){n=l[o];break}if(n)e.style.backgroundColor="",d.removeChild(n);else if(t){e.style.backgroundColor="#EEEB7E";var a=e.cloneNode(!0);d.appendChild(a)}var c=d.offsetWidth;r.style.paddingLeft=c+5+"px"}function o(e){var e=EventUtil.getEvent(e),t=i();if(8==e.keyCode&&""==r.value){d.removeChild(d.lastChild);var n=d.offsetWidth;r.style.paddingLeft=n+5+"px"}t===!1&&alert("标签数已达上限")}function a(){g.style.display="block"}function i(){var e=d.getElementsByTagName("span"),t=r.value,n=t.split(","),l=e.length+n.length;return!(l>5)}var r=document.getElementById("tags-input"),c=document.getElementById("common-tags"),d=document.getElementById("tags-div"),s=document.getElementById("tags"),u=document.getElementById("post-tags"),v=document.getElementById("cates-input"),g=document.getElementById("common-cates"),m=document.getElementById("cates-table");document.getElementById("upload");EventUtil.addHandler(r,"focus",e),EventUtil.addHandler(document,"click",t),EventUtil.addHandler(s,"click",n),EventUtil.addHandler(r,"keydown",o),EventUtil.addHandler(d,"click",function(e){var e=EventUtil.getEvent(e),t=EventUtil.getTarget(e);"span"==t.tagName.toLowerCase()&&d.removeChild(t)}),EventUtil.addHandler(v,"focus",a);var p=[];if(EventUtil.addHandler(m,"click",function(e){console.log(editor.value);for(var e=EventUtil.getEvent(e),t=EventUtil.getTarget(e),n=document.getElementById("form-article").elements.cates,l=!1,o=0;o<n.length;o++)t==n[o]&&(l=!0);if(l){p.length>0&&(p=v.value.split(",")),console.log(p);for(var o=0;o<p.length;o++)p[o].trim()||p.splice(o,1);var a=t.value;1==t.checked?p.push(a):p.splice(p.indexOf(a),1),v.value=p.join(","),console.log(v.value)}}),document.getElementById("submit")){var f=document.getElementById("submit");EventUtil.addHandler(f,"click",function(e){var e=EventUtil.getEvent(e);EventUtil.preventDefault(e),EventUtil.stopPropagation(e);var t=document.getElementById("form-article"),n=seriPost(t),l={};console.log(n);for(var o=(document.getElementById("pop-cont"),0);o<n.length;o++){var a=n[o].split("=");l[a[0]]=a[1]}console.log(decodeURIComponent(l.post)),ajax("post","/upload1","application/json",JSON.stringify(l),function(e){console.log(e);var n=document.querySelector(".p2"),l=Popuper({wrap:n,type:"success",confirm:function(){window.location.reload()},cancel:function(){var n=document.querySelector(".cancel");n.setAttribute("href","/detail/"+JSON.parse(e).author+"/"+t.elements.title.value)}}).edit({title:"提示",content:"文章上传成功"}).show();l.toggle().edit({type:"info"})})})}if(document.getElementById("save")){var E=document.getElementById("save");EventUtil.addHandler(E,"click",function(e){var e=EventUtil.getEvent(e);EventUtil.preventDefault(e),EventUtil.stopPropagation(e);var t=document.getElementById("form-article"),n=seriPost(t),l={};console.log(n);for(var o=(document.getElementById("pop-cont"),0);o<n.length;o++){var a=n[o].split("=");l[a[0]]=a[1]}console.log(l),ajax("put","/post/update","application/json",JSON.stringify(l),function(e){console.log(e);var n=document.querySelector(".p2"),l=Popuper({wrap:n,type:"success",confirm:function(){var e=document.querySelector(".confirm");e.setArrribute("href","/writePost")},cancel:function(){var n=document.querySelector(".cancel");n.setAttribute("href","/detail/"+JSON.parse(e).author+"/"+t.elements.title.value)}}).edit({title:"提示",content:"文章保存成功"}).show();l.toggle().edit({type:"info"})})})}}();