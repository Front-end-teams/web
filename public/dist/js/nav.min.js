!function(){function e(e){console.log("lig");var e=EventUtil.getEvent(e),l=EventUtil.getTarget(e),t=l.value,n={email:t},a=JSON.stringify(n),o=l.nextElementSibling||l.nextSibling;console.log(a),ajax("post","/reg/email","application/json",a,function(e){console.log("pot"),console.log(e),"reged"==e?(o.innerHTML="已注册",o.style.color="red",p.emails=!1):"success"==e&&(o.innerHTML="邮箱可用",o.style.color="green")})}function l(e){var l=e.value,t=e.nextElementSibling||e.nextSibling;if(0===l.length)return t.innerHTML="输入不能为空",void(t.style.color="red");if("reg-email"==e.id){var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$","i"),a={email:l},o=JSON.stringify(a);console.log(o),console.log(l),console.log(n.test(l)),n.test(l)?(t.innerHTML="邮箱格式正确",t.style.color="green",p.emails=!0):(t.innerHTML="请输入正确的邮箱",t.style.color="red",p.emails=!1)}"reg-password"==e.id&&(l.match(/^[a-zA-Z0-9]{6,16}$/)?(t.innerHTML="密码格式正确",t.style.color="green",p.passwords=!0):(t.innerHTML="请输入6到16位字符且只能为数字和字母",t.style.color="red",p.passwords=!1))}function t(e){EventUtil.preventDefault(e);var l=document.getElementById("log-email").value,t=document.getElementById("log-password").value,n=document.querySelector(".tip");if(0===l.length||0===t.length)return n.style.display="block",n.innerHTML="用户名和密码不能为空",void(n.style.color="red");var a={email:l,password:t},o=JSON.stringify(a);ajax("post","/login/password","application/json",o,function(l){if("match"!==l)return n.style.display="block",n.innerHTML="用户名与密码不一致",void(n.style.color="red");console.log("ccc"),console.log("ddd");var t=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var a=t.parentNode.parentNode,o=seriPost(a),r={},i=0;i<o.length;i++){var s=o[i].split("=");r[s[0]]=s[1]}var c=JSON.stringify(r);console.log(r),ajax("post","/login","application/json",c,function(e){console.log(e),"loginsuccess"==e&&(location.href="/")})})}var n=document.getElementById("mask"),a=new TabCard("regtab","defaultStyle","clickStyle");a.clear(),a.click();var o=document.getElementById("regForm"),r=document.getElementById("loginForm");if(o||r){var i=document.getElementById("login"),s=document.getElementById("reg"),c=document.getElementById("close"),d=document.getElementById("regtab"),g=o.querySelectorAll("input"),m=(o.querySelectorAll(".tip"),document.getElementById("regsub")),u=r.querySelectorAll("input"),v=(r.querySelectorAll(".tip"),document.getElementById("loginsub")),y=function(e){var t=e||window.e,n=t.target||t.srcElement,a=n.nextElementSibling||n.nextSibling;n.style.border="1px solid yellow",a.style.display="block",l(n)};null!==s&&(s.onclick=function(){d.className="show",n.className="maskshow";for(var l=a.panel,t=l.querySelectorAll("input"),o=0;o<t.length;o++)t[o].value="";for(var r=l.querySelectorAll(".tip"),o=0;o<r.length;o++)r[o].innerHTML="";var i=l.firstElementChild||l.firstChild,s=i.getElementsByTagName("li");s[0].className="defaultStyle",s[1].className="clickStyle";var c=l.lastElementChild||l.lastChild,m=c.getElementsByTagName("li");m[0].className="tabhide",m[1].className="tabshow";for(var o=0;o<g.length;o++)window.ActiveXObject&&(g[o].onpropertychange=y),EventUtil.addHandler(g[o],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"});EventUtil.addHandler(g[0],"input",y),EventUtil.addHandler(g[0],"blur",e),EventUtil.addHandler(g[1],"input",y)}),null!==i&&(i.onclick=function(){d.className="show",n.className="maskshow";for(var e=a.panel,l=e.querySelectorAll("input"),t=0;t<l.length;t++)l[t].value="";for(var o=e.querySelectorAll(".tip"),t=0;t<o.length;t++)o[t].innerHTML="";var r=e.firstElementChild||e.firstChild,i=r.getElementsByTagName("li");i[1].className="defaultStyle",i[0].className="clickStyle";var s=e.lastElementChild||e.lastChild,c=s.getElementsByTagName("li");c[0].className="tabshow",c[1].className="tabhide";for(var t=0;t<u.length;t++)window.ActiveXObject&&(u[t].onpropertychange=loginfn),EventUtil.addHandler(u[t],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"})}),c.onclick=function(){d.className="hide",n.className="maskhide"};var p={emails:!1,passwords:!1,validate:!1};EventUtil.addHandler(m,"click",function(e){if(1==p.emails&&1==p.passwords){var l=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var t=l.parentNode.parentNode,n=seriPost(t),a={},o=0;o<n.length;o++){var r=n[o].split("=");a[r[0]]=r[1]}var i=JSON.stringify(a);console.log(i),ajax("post","/reg","application/json",i,function(e){function l(){o-=1,a.innerHTML=o,0==o&&(location.href="/userSet",clearInterval(r))}if("regsuccess"==e){var t=document.getElementById("regsuccess"),n=document.getElementById("regForm");n.className="hide",t.className="tabshow";var a=document.getElementById("countdown"),o=5,r=setInterval(l,1e3)}})}else alert("请检查输入")}),EventUtil.addHandler(v,"click",t)}}();