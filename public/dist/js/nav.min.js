!function(){function e(e){console.log("lig");var e=EventUtil.getEvent(e),l=EventUtil.getTarget(e),t=l.value,n={email:t},a=JSON.stringify(n),o=l.nextElementSibling||l.nextSibling;console.log(a),ajax("post","/reg/email","application/json",a,function(e){console.log("pot"),console.log(e),"reged"==e?(o.innerHTML="已注册",o.style.color="red",p.emails=!1):"success"==e&&(o.innerHTML="邮箱可用",o.style.color="green")})}function l(e){var l=e.value,t=e.nextElementSibling||e.nextSibling;if(0===l.length)return t.innerHTML="输入不能为空",void(t.style.color="red");if("reg-email"==e.id){var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$","i"),a={email:l},o=JSON.stringify(a);console.log(o),console.log(l),console.log(n.test(l)),n.test(l)?(t.innerHTML="邮箱格式正确",t.style.color="green",p.emails=!0):(t.innerHTML="请输入正确的邮箱",t.style.color="red",p.emails=!1)}"reg-password"==e.id&&(l.match(/^[a-zA-Z0-9]{6,16}$/)?(t.innerHTML="密码格式正确",t.style.color="green",p.passwords=!0):(t.innerHTML="请输入6到16位字符且只能为数字和字母",t.style.color="red",p.passwords=!1))}function t(e){EventUtil.preventDefault(e);var l=document.getElementById("log-email").value,t=document.getElementById("log-password").value,o=document.querySelector(".tip");if(0===l.length||0===t.length)return o.style.display="block",o.innerHTML="用户名和密码不能为空",void(o.style.color="red");var r={email:l,password:t},i=JSON.stringify(r);ajax("post","/login/password","application/json",i,function(l){if("match"!==l)return o.style.display="block",o.innerHTML="用户名与密码不一致",void(o.style.color="red");console.log("ccc"),console.log("ddd");var t=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var r=t.parentNode.parentNode,i=seriPost(r),s={},c=0;c<i.length;c++){var d=i[c].split("=");s[d[0]]=d[1]}var g=JSON.stringify(s);console.log(s),ajax("post","/login","application/json",g,function(e){console.log(e),"loginsuccess"==e&&(n.style.display="none",a.style.display="none",window.location.reload())})})}var n=document.getElementById("mask"),a=document.getElementById("regtab"),o=new TabCard("regtab","defaultStyle","clickStyle");o.clear(),o.click();var r=document.getElementById("regForm"),i=document.getElementById("loginForm");if(r||i){var s=document.getElementById("login"),c=document.getElementById("reg"),d=document.getElementById("close"),a=document.getElementById("regtab"),g=r.querySelectorAll("input"),m=(r.querySelectorAll(".tip"),document.getElementById("regsub")),u=i.querySelectorAll("input"),v=(i.querySelectorAll(".tip"),document.getElementById("loginsub")),y=function(e){var t=e||window.e,n=t.target||t.srcElement,a=n.nextElementSibling||n.nextSibling;n.style.border="1px solid yellow",a.style.display="block",l(n)};null!==c&&(c.onclick=function(){a.className="show",n.className="maskshow";for(var l=o.panel,t=l.querySelectorAll("input"),r=0;r<t.length;r++)t[r].value="";for(var i=l.querySelectorAll(".tip"),r=0;r<i.length;r++)i[r].innerHTML="";var s=l.firstElementChild||l.firstChild,c=s.getElementsByTagName("li");c[0].className="defaultStyle",c[1].className="clickStyle";var d=l.lastElementChild||l.lastChild,m=d.getElementsByTagName("li");m[0].className="tabhide",m[1].className="tabshow";for(var r=0;r<g.length;r++)window.ActiveXObject&&(g[r].onpropertychange=y),EventUtil.addHandler(g[r],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"});EventUtil.addHandler(g[0],"input",y),EventUtil.addHandler(g[0],"blur",e),EventUtil.addHandler(g[1],"input",y)}),null!==s&&(s.onclick=function(){a.className="show",n.className="maskshow";for(var e=o.panel,l=e.querySelectorAll("input"),t=0;t<l.length;t++)l[t].value="";for(var r=e.querySelectorAll(".tip"),t=0;t<r.length;t++)r[t].innerHTML="";var i=e.firstElementChild||e.firstChild,s=i.getElementsByTagName("li");s[1].className="defaultStyle",s[0].className="clickStyle";var c=e.lastElementChild||e.lastChild,d=c.getElementsByTagName("li");d[0].className="tabshow",d[1].className="tabhide";for(var t=0;t<u.length;t++)window.ActiveXObject&&(u[t].onpropertychange=loginfn),EventUtil.addHandler(u[t],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"})}),d.onclick=function(){a.className="hide",n.className="maskhide"};var p={emails:!1,passwords:!1,validate:!1};EventUtil.addHandler(m,"click",function(e){if(1==p.emails&&1==p.passwords){var l=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var t=l.parentNode.parentNode,n=seriPost(t),a={},o=0;o<n.length;o++){var r=n[o].split("=");a[r[0]]=r[1]}var i=JSON.stringify(a);console.log(i),ajax("post","/reg","application/json",i,function(e){function l(){o-=1,a.innerHTML=o,0==o&&(location.href="/userSet",clearInterval(r))}if("regsuccess"==e){var t=document.getElementById("regsuccess"),n=document.getElementById("regForm");n.className="hide",t.className="tabshow";var a=document.getElementById("countdown"),o=5,r=setInterval(l,1e3)}})}else alert("请检查输入")}),EventUtil.addHandler(v,"click",t)}}();