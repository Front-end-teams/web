!function(){function e(e){console.log("lig");var e=EventUtil.getEvent(e),l=EventUtil.getTarget(e),t=l.value,n={email:t},r=JSON.stringify(n),a=l.nextElementSibling||l.nextSibling;console.log(r),ajax("post","/reg/email","application/json",r,function(e){console.log("pot"),console.log(e),"reged"==e?(a.innerHTML="已注册",a.style.color="red",S.emails=!1):"success"==e&&(a.innerHTML="邮箱可用",a.style.color="green")})}function l(e){var l=e.value,t=e.nextElementSibling||e.nextSibling;if(0===l.length)return t.innerHTML="输入不能为空",void(t.style.color="red");if("reg-email"==e.id){var n=new RegExp("^([a-zA-Z0-9_.-])+@(([a-zA-Z0-9-])+.)+([a-zA-Z0-9]{2,4})+$","i"),r={email:l},a=JSON.stringify(r);console.log(a),console.log(l),console.log(n.test(l)),n.test(l)?(t.innerHTML="邮箱格式正确",t.style.color="green",S.emails=!0):(t.innerHTML="请输入正确的邮箱",t.style.color="red",S.emails=!1)}"reg-password"==e.id&&(l.match(/^[a-zA-Z0-9]{6,16}$/)?(t.innerHTML="密码格式正确",t.style.color="green",S.passwords=!0):(t.innerHTML="请输入6到16位字符且只能为数字和字母",t.style.color="red",S.passwords=!1))}function t(e){EventUtil.preventDefault(e);var l=document.getElementById("log-email").value,t=document.getElementById("log-password").value,n=document.querySelector(".tip");if(0===l.length||0===t.length)return n.style.display="block",n.innerHTML="用户名和密码不能为空",void(n.style.color="red");var r={email:l,password:t},a=JSON.stringify(r);ajax("post","/login/password","application/json",a,function(l){if("match"!==l)return n.style.display="block",n.innerHTML=l,void(n.style.color="red");console.log("ccc"),console.log("ddd");var t=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var r=t.parentNode.parentNode,a=seriPost(r),o={},i=0;i<a.length;i++){var s=a[i].split("=");o[s[0]]=s[1]}var c=JSON.stringify(o);console.log(o),ajax("post","/login","application/json",c,function(e){console.log(e),"loginsuccess"==e&&(window.location.href="/")})})}var n=document.getElementById("regtab"),r=new TabCard("regtab","defaultStyle","clickStyle");r.clear(),r.click();var a=document.getElementById("regForm"),o=document.getElementById("loginForm");if(a||o){var i=document.getElementById("login"),s=document.getElementById("reg"),n=(document.getElementById("close"),document.getElementById("regtab")),c=a.querySelectorAll("input"),d=(a.querySelectorAll(".tip"),document.getElementById("regsub")),g=o.querySelectorAll("input"),m=(o.querySelectorAll(".tip"),document.getElementById("loginsub")),u=function(e){var t=e||window.e,n=t.target||t.srcElement,r=n.nextElementSibling||n.nextSibling;n.style.border="1px solid yellow",r.style.display="block",l(n)};if(null!==s){n.className="show";for(var v=r.panel,y=v.querySelectorAll("input"),p=0;p<y.length;p++)y[p].value="";for(var f=v.querySelectorAll(".tip"),p=0;p<f.length;p++)f[p].innerHTML="";var E=v.firstElementChild||v.firstChild,h=E.getElementsByTagName("li");h[0].className="defaultStyle",h[1].className="clickStyle";var w=v.lastElementChild||v.lastChild,b=w.getElementsByTagName("li");b[0].className="tabhide",b[1].className="tabshow";for(var p=0;p<c.length;p++)window.ActiveXObject&&(c[p].onpropertychange=u),EventUtil.addHandler(c[p],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"});EventUtil.addHandler(c[0],"input",u),EventUtil.addHandler(c[0],"blur",e),EventUtil.addHandler(c[1],"input",u)}if(null!==i){n.className="show",o.className="navform";for(var v=r.panel,y=v.querySelectorAll("input"),p=0;p<y.length;p++)y[p].value="";for(var f=v.querySelectorAll(".tip"),p=0;p<f.length;p++)f[p].innerHTML="";var E=v.firstElementChild||v.firstChild,h=E.getElementsByTagName("li");h[1].className="defaultStyle",h[0].className="clickStyle";var w=v.lastElementChild||v.lastChild,b=w.getElementsByTagName("li");b[0].className="tabshow",b[1].className="tabhide";for(var p=0;p<g.length;p++)window.ActiveXObject&&(g[p].onpropertychange=loginfn),EventUtil.addHandler(g[p],"blur",function(e){var l=e||window.e,t=l.target||l.srcElement;t.style.border="1px solid #1AE6E6"})}var S={emails:!1,passwords:!1,validate:!1};EventUtil.addHandler(d,"click",function(e){if(1==S.emails&&1==S.passwords){var l=EventUtil.getTarget(e);EventUtil.preventDefault(e);for(var t=l.parentNode.parentNode,n=seriPost(t),r={},a=0;a<n.length;a++){var o=n[a].split("=");r[o[0]]=o[1]}var i=JSON.stringify(r);console.log(i),ajax("post","/reg","application/json",i,function(e){function l(){a-=1,r.innerHTML=a,0==a&&(location.href="/userSet",clearInterval(o))}if("regsuccess"==e){var t=document.getElementById("regsuccess"),n=document.getElementById("regForm");n.className="hide",t.className="tabshow";var r=document.getElementById("countdown"),a=5,o=setInterval(l,1e3)}})}else alert("请检查输入")}),EventUtil.addHandler(m,"click",t)}}();